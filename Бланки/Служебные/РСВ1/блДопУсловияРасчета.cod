class inherited ТББ_Базовый.Базовые.БазовыйБланк "Доп.условия расчета";

inclass public

  --{{ Вспомогательные методы

  func CreateExt: Служебные.РСВ1.блДопУсловияРасчета;
    Result = Служебные.РСВ1.блДопУсловияРасчета.Create;
  end;
  --}}

inobject public

  --{{ Свойства

  var Уточненение: logical;
  var НомерУточнения: integer;
  var ОтчГод: integer;
  var ОтчПериод: integer;
  var СтажНС1: logical;
  var СтажНС2: logical;
  var СтажНС3: logical;
  var СтажНС4: logical;
  var СтажГПС: logical;
  var УточнениеСтажа: logical = (true in [СтажНС1,СтажНС2,СтажНС3,СтажНС4,СтажГПС]);
  var ВсеСотрудники: logical = not УточнениеСтажа;
  --}}

  --{{ Обработчики событий шаблона

  proc шаблон_ПриОткрытии(Create :Logical);
    inherited шаблон_ПриОткрытии(Create);
    Template.CellByField['УточнениеСтажа'].Enabled = false;
    Template.CellByField['ВсеСотрудники'].Enabled = false;
  end;
  --}}

  --{{ Обработчики событий клеток шаблона

  proc Поле_ПриВыходе (Cell: TemplateCell; Index: Integer);
    if (Cell.Contents = 'Уточненение'):
      if Уточненение and (НомерУточнения = 0): НомерУточнения = 1;
      elsif not Уточненение and (НомерУточнения > 0): НомерУточнения = 0;
      fi;
    elsif (Cell.Contents = 'НомерУточнения'):
      Уточненение = (НомерУточнения > 0);
    fi;
  end;

  func Поле_ПриВыводе (Cell: TemplateCell; Value: Variant; Action: Template.OutputTypes; var Format: String): Variant;
    if (Cell.Contents = 'НомерУточнения'):
      Cell.Enabled = Уточненение;
      Return НомерУточнения;
    fi;
  end;

  proc Поле_ПриРисовании (Cell: TemplateCell; Selected: Logical; var Color: Integer; var FieldColor: Integer; Font: Font);
    if (Cell.Contents = 'НомерУточнения'):
      if Уточненение:
        inherited ПриРисовании_КакПолеВвода (Cell, Selected, Color, FieldColor, Font);
      else
        inherited ПриРисовании_КакЗапрещенное (Cell, Selected, Color, FieldColor, Font);
      fi;
    fi;
  --ПриРисовании_КакЗапрещенное
    -- Обработка события рисования клетки
    -- Параметры:
    --   Cell: клетка шаблона
    --   Selected: Попадает ли клетка в выделенный блок
    --   Color: цвет фона клетки
    --   Font:  шрифт клетки
    --   FieldColor: цвет поля клетки
  end;


  --}}


end